# https://taskfile.dev

version: '3'

vars:
  GREETING: Hello, World!

tasks:
  default:
    cmds:
      - echo "{{.GREETING}}"
      - task -a
    silent: true
    
  build:
    desc: build release-art
    cmds:
    - mkdir -p release/
    - cp -r devpod release/devpod
    
  post-build-stamp:
    desc: _
    vars:
      base_file_url: https://raw.githubusercontent.com/yairdar/devpod/main/src/devpod
      # items_expr: ls -1 release/devpod | sed "s@^@{{.base_file_url}}/@"
      items:
        sh: ls -1 release/devpod
    cmds:
    - |-
      cat << FQD > init.sh
      #!/usr/bin/env sh
      set -e
      BASE_FILE_URL={{.base_file_url}}
      mkdir -p devpod && cd devpod      
      xargs -P 4 -I{} wget \$BASE_FILE_URL/{} -O {} << FHJ
      {{.items}}
      FHJ
      FQD